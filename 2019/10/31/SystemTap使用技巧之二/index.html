<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>SystemTap使用技巧之二 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="接上一篇内容，本文主要介绍 system tap 使用技巧（下一篇继续讲技巧） 7. 技巧7.1 定位函数位置在一个大型项目中找出函数在哪里定义有时很有用，特别是一些比较难找出在哪里定义的函数，比如内核或者 glibc 中的某个函数想要看其实现时，首先得找出其在哪个文件的哪一行定义，用 SystemTap 一行命令就可以搞定。 比如要看 printf 在 glibc 中哪里定义的： 12root@">
<meta property="og:type" content="article">
<meta property="og:title" content="SystemTap使用技巧之二">
<meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2019&#x2F;10&#x2F;31&#x2F;SystemTap%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7%E4%B9%8B%E4%BA%8C&#x2F;index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="接上一篇内容，本文主要介绍 system tap 使用技巧（下一篇继续讲技巧） 7. 技巧7.1 定位函数位置在一个大型项目中找出函数在哪里定义有时很有用，特别是一些比较难找出在哪里定义的函数，比如内核或者 glibc 中的某个函数想要看其实现时，首先得找出其在哪个文件的哪一行定义，用 SystemTap 一行命令就可以搞定。 比如要看 printf 在 glibc 中哪里定义的： 12root@">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2019-10-31T08:20:56.249Z">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-SystemTap使用技巧之二" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/10/31/SystemTap%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7%E4%B9%8B%E4%BA%8C/" class="article-date">
  <time datetime="2019-10-31T08:09:55.000Z" itemprop="datePublished">2019-10-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      SystemTap使用技巧之二
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>接上一篇内容，本文主要介绍 system tap 使用技巧（下一篇继续讲技巧）</p>
<h2 id="7-技巧"><a href="#7-技巧" class="headerlink" title="7. 技巧"></a>7. 技巧</h2><h3 id="7-1-定位函数位置"><a href="#7-1-定位函数位置" class="headerlink" title="7.1 定位函数位置"></a>7.1 定位函数位置</h3><p>在一个大型项目中找出函数在哪里定义有时很有用，特别是一些比较难找出在哪里定义的函数，比如内核或者 glibc 中的某个函数想要看其实现时，首先得找出其在哪个文件的哪一行定义，用 SystemTap 一行命令就可以搞定。 比如要看 printf 在 glibc 中哪里定义的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@j9 ~# stap -l &apos;process(&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;).function(&quot;printf&quot;)&apos; </span><br><span class="line">process(&quot;/lib/x86_64-linux-gnu/libc-2.15.so&quot;).function(&quot;__printf@/build/buildd/eglibc-2.15/stdio-common/printf.c:29&quot;)</span><br></pre></td></tr></table></figure>

<p>可以看出 printf 是在 printf.c 第 29 行定义的。 再比如要看内核中 recv 系统的调用是在哪里定义的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@j9 ~# stap -l &apos;kernel.function(&quot;sys_recv&quot;)&apos;</span><br><span class="line">kernel.function(&quot;sys_recv@/build/buildd/linux-lts-trusty-3.13.0/net/socket.c:1868&quot;)</span><br></pre></td></tr></table></figure>

<p>可以看出 recv 是在 socket.c 第 1868 行定义的。 甚至可以*号来模糊查找：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">root@j9 ~# stap -l &apos;kernel.function(&quot;*recv&quot;)&apos;   </span><br><span class="line">kernel.function(&quot;__audit_mq_sendrecv@/build/buildd/linux-lts-trusty-3.13.0/kernel/auditsc.c:2062&quot;)</span><br><span class="line">kernel.function(&quot;audit_mq_sendrecv@/build/buildd/linux-lts-trusty-3.13.0/include/linux/audit.h:263&quot;)</span><br><span class="line">kernel.function(&quot;compat_sys_recv@/build/buildd/linux-lts-trusty-3.13.0/net/compat.c:762&quot;)</span><br><span class="line">kernel.function(&quot;i2c_master_recv@/build/buildd/linux-lts-trusty-3.13.0/drivers/i2c/i2c-core.c:1827&quot;)</span><br><span class="line">kernel.function(&quot;ip_cmsg_recv@/build/buildd/linux-lts-trusty-3.13.0/net/ipv4/ip_sockglue.c:147&quot;)</span><br><span class="line">kernel.function(&quot;kgdb_tty_recv@/build/buildd/linux-lts-trusty-3.13.0/drivers/tty/serial/kgdb_nmi.c:109&quot;)</span><br><span class="line">kernel.function(&quot;ppp_do_recv@/build/buildd/linux-lts-trusty-3.13.0/drivers/net/ppp/ppp_generic.c:1617&quot;)</span><br><span class="line">kernel.function(&quot;scm_recv@/build/buildd/linux-lts-trusty-3.13.0/include/net/scm.h:109&quot;)</span><br><span class="line">kernel.function(&quot;sys_recv@/build/buildd/linux-lts-trusty-3.13.0/net/socket.c:1868&quot;)</span><br><span class="line">kernel.function(&quot;tcp_event_data_recv@/build/buildd/linux-lts-trusty-3.13.0/net/ipv4/tcp_input.c:615&quot;)</span><br><span class="line">kernel.function(&quot;tcp_splice_data_recv@/build/buildd/linux-lts-trusty-3.13.0/net/ipv4/tcp.c:637&quot;)</span><br><span class="line">kernel.function(&quot;tpm_tis_recv@/build/buildd/linux-lts-trusty-3.13.0/drivers/char/tpm/tpm_tis.c:231&quot;)</span><br><span class="line">kernel.function(&quot;try_fill_recv@/build/buildd/linux-lts-trusty-3.13.0/drivers/net/virtio_net.c:615&quot;)</span><br></pre></td></tr></table></figure>

<p>同理，也可以用来定位用户进程的函数位置： 比如 tengine 的文件 ngx_shmem.c 里面为了兼容各个操作系统而实现了三个版本的 ngx_shm_alloc，用#if (NGX_HAVE_MAP_ANON)、#elif (NGX_HAVE_MAP_DEVZERO)、#elif (NGX_HAVE_SYSVSHM)、#endif 来做条件编译，那怎么知道编译出来的是哪个版本呢，用 SystemTap 的话就很简单了，否则要去 grep 一下这几宏有没有定义才知道了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@cache4 tengine]# stap -l &apos;process(&quot;/home/admin/tengine/bin/nginx&quot;).function(&quot;ngx_shm_alloc&quot;)&apos;</span><br><span class="line">process(&quot;/home/admin/tengine/bin/nginx&quot;).function(&quot;ngx_shm_alloc@src/os/unix/ngx_shmem.c:15&quot;)</span><br></pre></td></tr></table></figure>

<h3 id="7-2-查看可用探测点以及该探测点上可用的变量"><a href="#7-2-查看可用探测点以及该探测点上可用的变量" class="headerlink" title="7.2 查看可用探测点以及该探测点上可用的变量"></a>7.2 查看可用探测点以及该探测点上可用的变量</h3><p>在一些探测点上能获取的变量比较有限，这是因为这些变量可能已经被编译器优化掉了，优化掉的变量就获取不到了。一般先用-L 参数来看看有哪些变量可以直接使用：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@cache4 tengine]# stap -L &apos;process(&quot;/home/admin/tengine/bin/nginx&quot;).function(&quot;ngx_shm_alloc&quot;)&apos; </span><br><span class="line">process(&quot;/home/admin/tengine/bin/nginx&quot;).function(&quot;ngx_shm_alloc@src/os/unix/ngx_shmem.c:15&quot;) $shm:ngx_shm_t*</span><br></pre></td></tr></table></figure>

<p>可见在该探测点上可以直接使用$shm 这个变量，其类型是 ngx_shm_t*。 statement 探测点也类似：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@cache4 tengine]# stap -L &apos;process(&quot;/home/admin/tengine/bin/nginx&quot;).statement(&quot;ngx_pcalloc@src/core/ngx_palloc.c:*&quot;)&apos;                   </span><br><span class="line">process(&quot;/home/admin/tengine/bin/nginx&quot;).statement(&quot;ngx_pcalloc@src/core/ngx_palloc.c:395&quot;) $pool:ngx_pool_t* $size:size_t</span><br><span class="line">process(&quot;/home/admin/tengine/bin/nginx&quot;).statement(&quot;ngx_pcalloc@src/core/ngx_palloc.c:398&quot;) $pool:ngx_pool_t* $size:size_t</span><br><span class="line">process(&quot;/home/admin/tengine/bin/nginx&quot;).statement(&quot;ngx_pcalloc@src/core/ngx_palloc.c:399&quot;) $size:size_t</span><br><span class="line">process(&quot;/home/admin/tengine/bin/nginx&quot;).statement(&quot;ngx_pcalloc@src/core/ngx_palloc.c:404&quot;) $size:size_t $p:void*</span><br></pre></td></tr></table></figure>

<h3 id="7-3-输出调用堆栈"><a href="#7-3-输出调用堆栈" class="headerlink" title="7.3 输出调用堆栈"></a>7.3 输出调用堆栈</h3><p>用户态探测点堆栈：print_ubacktrace()、sprint_ubacktrace() 内核态探测点堆栈：print_backtrace()、sprint_backtrace() 不带 s 和带 s 的区别是前者直接输出，后者是返回堆栈字符串。 这几个函数非常有用，在排查问题时可以根据一些特定条件来过滤函数被执行时是怎么调用进来的，比如排查 tengine 返回 5xx 时的调用堆栈是怎样的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#cat debug_tengine_5xx.stp </span><br><span class="line">probe process(&quot;/home/admin/tengine/bin/nginx&quot;).function(&quot;ngx_http_finalize_request&quot;).call &#123;</span><br><span class="line">    if ($rc &gt;= 500) &#123;</span><br><span class="line">        printf(&quot;rc: %d\n&quot;, $rc)</span><br><span class="line">        print_ubacktrace()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#stap debug_tengine_5xx.stp </span><br><span class="line">rc: 502</span><br><span class="line"> 0x49af2e : ngx_http_finalize_request+0xe/0x480 [/home/admin/tengine/bin/nginx]</span><br><span class="line"> 0x543305 : ngx_http_video_flv_send_rest+0xf5/0x380 [/home/admin/tengine/bin/nginx]</span><br><span class="line"> 0x543187 : ngx_http_video_finalize_request+0x57/0xe0 [/home/admin/tengine/bin/nginx]</span><br><span class="line"> 0x49828f : ngx_http_terminate_request+0x4f/0xc0 [/home/admin/tengine/bin/nginx]</span><br><span class="line"> 0x49b760 : ngx_http_test_reading+0x50/0x130 [/home/admin/tengine/bin/nginx]</span><br><span class="line"> 0x49779f : ngx_http_request_handler+0x1f/0x40 [/home/admin/tengine/bin/nginx]</span><br><span class="line"> 0x47ea8f : ngx_epoll_process_events+0x2df/0x330 [/home/admin/tengine/bin/nginx]</span><br><span class="line"> 0x4753f9 : ngx_process_events_and_timers+0x69/0x1c0 [/home/admin/tengine/bin/nginx]</span><br><span class="line"> 0x47d4d8 : ngx_worker_process_cycle+0x138/0x260 [/home/admin/tengine/bin/nginx]</span><br><span class="line"> 0x47a38a : ngx_spawn_process+0x1ca/0x5e0 [/home/admin/tengine/bin/nginx]</span><br><span class="line"> 0x47c73c : ngx_start_worker_processes+0x7c/0x100 [/home/admin/tengine/bin/nginx]</span><br><span class="line"> 0x47db5f : ngx_master_process_cycle+0x3af/0x9b0 [/home/admin/tengine/bin/nginx]</span><br><span class="line"> 0x45a740 : main+0xa90/0xb50 [/home/admin/tengine/bin/nginx]</span><br><span class="line"> 0x3623e1ecdd [/lib64/libc-2.12.so+0x1ecdd/0x38d000]</span><br></pre></td></tr></table></figure>

<p>比如看看内核是怎么收包的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">root@jusse ~# cat netif_receive_skb.stp </span><br><span class="line">probe kernel.function(&quot;netif_receive_skb&quot;) </span><br><span class="line">&#123; </span><br><span class="line">    printf(&quot;--------------------------------------------------------\n&quot;); </span><br><span class="line">    print_backtrace(); </span><br><span class="line">    printf(&quot;--------------------------------------------------------\n&quot;); </span><br><span class="line">&#125; </span><br><span class="line">root@jusse ~# stap netif_receive_skb.stp</span><br><span class="line">--------------------------------------------------------</span><br><span class="line"> 0xffffffff8164dc00 : netif_receive_skb+0x0/0x90 [kernel]</span><br><span class="line"> 0xffffffff8164e280 : napi_gro_receive+0xb0/0x130 [kernel]</span><br><span class="line"> 0xffffffff81554537 : handle_incoming_queue+0xe7/0x100 [kernel]</span><br><span class="line"> 0xffffffff815555d9 : xennet_poll+0x279/0x430 [kernel]</span><br><span class="line"> 0xffffffff8164ee09 : net_rx_action+0x139/0x250 [kernel]</span><br><span class="line"> 0xffffffff810702cd : __do_softirq+0xdd/0x300 [kernel]</span><br><span class="line"> 0xffffffff8107088e : irq_exit+0x11e/0x140 [kernel]</span><br><span class="line"> 0xffffffff8144e785 : xen_evtchn_do_upcall+0x35/0x50 [kernel]</span><br><span class="line"> 0xffffffff8176c9ed : xen_hvm_callback_vector+0x6d/0x80 [kernel]</span><br><span class="line">--------------------------------------------------------</span><br></pre></td></tr></table></figure>

<h3 id="7-4-获取函数参数"><a href="#7-4-获取函数参数" class="headerlink" title="7.4 获取函数参数"></a>7.4 获取函数参数</h3><p>一些被编译器优化掉的函数参数用-L 去看的时候没有找到，这样的话在探测点里面也不能直接用$方式获取该参数变量，这时可以使用 SystemTap 提供的<em>_arg 函数接口，</em>是根据类型指定的，比如 pointer_arg 是获取指针类型参数，int_arg 是获取整型参数，类似的还有 long_arg、longlong_arg、uint_arg、ulong_arg、ulonglong_arg、s32_arg、s64_arg、u32_arg、u64_arg：</p>
<p>image</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">root@j9 ~# stap -L &apos;kernel.function(&quot;sys_open&quot;)&apos; </span><br><span class="line">kernel.function(&quot;SyS_open@/build/buildd/linux-lts-trusty-3.13.0/fs/open.c:1011&quot;) $ret:long int</span><br><span class="line">root@j9 ~# cat sys_open.stp </span><br><span class="line">probe kernel.function(&quot;sys_open&quot;).call</span><br><span class="line">&#123;</span><br><span class="line">    printf(&quot;filename: %p(%s), flags: %d, mode: %x\n&quot;, pointer_arg(1), kernel_string(pointer_arg(1)), int_arg(2), int_arg(3));</span><br><span class="line">&#125;</span><br><span class="line">root@j9 ~# stap sys_open.stp </span><br><span class="line">filename: 0xc2081d2120(/proc/stat), flags: 524288, mode: 0</span><br><span class="line">filename: 0x7facec00e838(/root/opt/libexec/systemtap/stapio), flags: 0, mode: 1b6</span><br><span class="line">filename: 0x2219488(/var/log/auth.log), flags: 0, mode: 1b6</span><br><span class="line">filename: 0x7facec00e838(/root/opt/libexec/systemtap/stapio), flags: 0, mode: 1b6</span><br><span class="line">filename: 0x7fad10172c29(/etc/passwd), flags: 524288, mode: 1b6</span><br><span class="line">^C</span><br></pre></td></tr></table></figure>

<p>再比如两个函数的函数参数类型兼容也可以使用这种方法获取： image</p>
<p>这两个函数的参数完全兼容，只是第二个参数命名不一样而已，可以像下面这么用：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#cat debug_tengine_5xx.stp </span><br><span class="line">probe process(&quot;/home/admin/tengine/bin/nginx&quot;).function(&quot;ngx_http_finalize_request&quot;).call, process(&quot;/home/admin/tengine/bin/nginx&quot;).function(&quot;ngx_http_special_response_handler&quot;).call &#123;</span><br><span class="line">    rc = int_arg(2)</span><br><span class="line">    if (rc &gt;= 500) &#123;</span><br><span class="line">        printf(&quot;rc: %d\n&quot;, rc)</span><br><span class="line">        print_ubacktrace()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-5-获取全局变量"><a href="#7-5-获取全局变量" class="headerlink" title="7.5 获取全局变量"></a>7.5 获取全局变量</h3><p>有时候用$可以直接获取到全局变量，但有时候又获取不到，那可以试试 @var： 比如获取 nginx 的全局变量 ngx_cycyle：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">root@j9 ~# cat get_ngx_cycle.stp</span><br><span class="line">probe process(&quot;/home/admin/tengine/bin/nginx&quot;).function(&quot;ngx_process_events_and_timers&quot;).call &#123;</span><br><span class="line">    printf(&quot;ngx_cycle-&gt;connections: %d\n&quot;, $ngx_cycle-&gt;connections)</span><br><span class="line">    exit()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">root@j9 ~# stap get_ngx_cycle.stp</span><br><span class="line">semantic error: while processing probe process(&quot;/home/admin/tengine/bin/nginx&quot;).function(&quot;ngx_process_events_and_timers@src/event/ngx_event.c:225&quot;).call from: process(&quot;/home/admin/tengine/bin/nginx&quot;).function(&quot;ngx_process_events_and_timers&quot;).call</span><br><span class="line"></span><br><span class="line">semantic error: unable to find local &apos;ngx_cycle&apos;, [man error::dwarf] dieoffset 0x73ca8 in /home/admin/tengine/bin/nginx, near pc 0x434152 in ngx_process_events_and_timers src/event/ngx_event.c (alternatives: $cycle, $delta, $timer, $flags)): identifier &apos;$ngx_cycle&apos; at get_ngx_cycle.stp:3:44</span><br><span class="line">        source:     printf(&quot;ngx_cycle-&gt;connections: %d\n&quot;, $ngx_cycle-&gt;connections)</span><br><span class="line">                                                           ^</span><br><span class="line"></span><br><span class="line">Pass 2: analysis failed.  [man error::pass2]</span><br><span class="line"></span><br><span class="line">root@j9 ~# cat get_ngx_cycle.stp</span><br><span class="line">probe process(&quot;/home/admin/tengine/bin/nginx&quot;).function(&quot;ngx_process_events_and_timers&quot;).call &#123;</span><br><span class="line">    ngx_cycle = @var(&quot;ngx_cycle@src/core/ngx_cycle.c&quot;)</span><br><span class="line">    printf(&quot;ngx_cycle-&gt;connections: %d\n&quot;, ngx_cycle-&gt;connections)</span><br><span class="line">    exit()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">root@j9 ~# stap get_ngx_cycle.stp</span><br><span class="line">ngx_cycle-&gt;connections: 19507312</span><br></pre></td></tr></table></figure>

<h3 id="7-6-获取数据结构成员用法"><a href="#7-6-获取数据结构成员用法" class="headerlink" title="7.6 获取数据结构成员用法"></a>7.6 获取数据结构成员用法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">typedef struct &#123;</span><br><span class="line">    size_t      len;</span><br><span class="line">    u_char     *data;</span><br><span class="line">&#125; ngx_str_t;</span><br><span class="line"></span><br><span class="line">struct ngx_http_request_s &#123;</span><br><span class="line">    ......</span><br><span class="line">    ngx_uint_t                        method;</span><br><span class="line">    ngx_uint_t                        http_version;</span><br><span class="line"></span><br><span class="line">    ngx_str_t                         request_line;</span><br><span class="line">    ngx_str_t                         raw_uri;</span><br><span class="line">    ngx_str_t                         uri;</span><br><span class="line">    ......</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>上面这个是 nginx 里面的 http 请求结构里面的几个成员，在 C 语言里，如果 r 是 struct ngx_http_request_t *，那么要获取 uri 的 data 是这样的：r-&gt;uri.data，但在 SystemTap 里面，不管是指针还是数据结构，都是用-&gt;访问其成员：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">#cat get_http_uri.stp</span><br><span class="line">probe process(&quot;/home/admin/tengine/bin/nginx&quot;).function(&quot;ngx_http_process_request&quot;).call &#123;</span><br><span class="line">    printf(&quot;r-&gt;uri.len: %d, r-&gt;uri.data: %p\n&quot;, $r-&gt;uri.len, $r-&gt;uri.data)</span><br><span class="line">&#125;</span><br><span class="line">#stap get_http_uri.stp</span><br><span class="line">WARNING: never-assigned local variable &apos;len&apos; (similar: data): identifier &apos;len&apos; at get_http_uri.stp:2:57</span><br><span class="line"> source:     printf(&quot;r-&gt;uri.len: %d, r-&gt;uri.data: %p\n&quot;, $r-&gt;uri.len, $r-&gt;uri.data)</span><br><span class="line">                                                                 ^</span><br><span class="line">WARNING: never-assigned local variable &apos;data&apos; (similar: len): identifier &apos;data&apos; at :2:70</span><br><span class="line"> source:     printf(&quot;r-&gt;uri.len: %d, r-&gt;uri.data: %p\n&quot;, $r-&gt;uri.len, $r-&gt;uri.data)</span><br><span class="line">                                                                              ^</span><br><span class="line">semantic error: invalid operator: operator &apos;.&apos; at :2:56</span><br><span class="line">        source:     printf(&quot;r-&gt;uri.len: %d, r-&gt;uri.data: %p\n&quot;, $r-&gt;uri.len, $r-&gt;uri.data)</span><br><span class="line">                                                                       ^</span><br><span class="line"></span><br><span class="line">semantic error: type mismatch: expected long but found string: operator &apos;.&apos; at :2:56</span><br><span class="line">        source:     printf(&quot;r-&gt;uri.len: %d, r-&gt;uri.data: %p\n&quot;, $r-&gt;uri.len, $r-&gt;uri.data)</span><br><span class="line">                                                                       ^</span><br><span class="line"></span><br><span class="line">Pass 2: analysis failed.  [man error::pass2]</span><br><span class="line"></span><br><span class="line">#cat get_http_uri.stp</span><br><span class="line">probe process(&quot;/home/admin/tengine/bin/nginx&quot;).function(&quot;ngx_http_process_request&quot;).call &#123;</span><br><span class="line">    printf(&quot;r-&gt;uri.len: %d, r-&gt;uri.data: %p\n&quot;, $r-&gt;uri-&gt;len, $r-&gt;uri-&gt;data)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#stap get_http_uri.stp</span><br><span class="line">r-&gt;uri.len: 1, r-&gt;uri.data: 0x1276f94</span><br><span class="line">r-&gt;uri.len: 1, r-&gt;uri.data: 0x11d5fc4</span><br><span class="line">r-&gt;uri.len: 1, r-&gt;uri.data: 0x124fd24</span><br><span class="line">^C</span><br></pre></td></tr></table></figure>

<h3 id="7-7-输出整个数据结构"><a href="#7-7-输出整个数据结构" class="headerlink" title="7.7 输出整个数据结构"></a>7.7 输出整个数据结构</h3><p>SystemTap 有两个语法可以输出整个数据结构：在变量的后面加一个或者两个</p>
<p>$即可，例子如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#cat get_r_pool.stp</span><br><span class="line">probe process(&quot;/home/admin/tengine/bin/nginx&quot;).function(&quot;ngx_http_process_request&quot;).call &#123;</span><br><span class="line">    printf(&quot;$r-&gt;pool$: %s\n$r-&gt;pool$$: %s\n&quot;, $r-&gt;pool$, $r-&gt;pool$$)</span><br><span class="line">&#125;</span><br><span class="line">#stap get_r_pool.stp</span><br><span class="line">$r-&gt;pool$: &#123;.d=&#123;...&#125;, .max=4016, .current=0x161acd0, .chain=0x0, .large=0x0, .cleanup=0x0, .log=0x161c690&#125;</span><br><span class="line">$r-&gt;pool$$: &#123;.d=&#123;.last=&quot;a&quot;, .end=&quot;&quot;, .next=0x1617650, .failed=0&#125;, .max=4016, .current=0x161acd0, .chain=0x0, .large=0x0, .cleanup=0x0, .log=0x161c690&#125;</span><br></pre></td></tr></table></figure>

<p>其中 r-&gt;pool 的结构如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">typedef struct &#123;</span><br><span class="line">    u_char               *last;</span><br><span class="line">    u_char               *end;</span><br><span class="line">    ngx_pool_t           *next;</span><br><span class="line">    ngx_uint_t            failed;</span><br><span class="line">&#125; ngx_pool_data_t;</span><br><span class="line"></span><br><span class="line">struct ngx_pool_s &#123;</span><br><span class="line">    ngx_pool_data_t       d;</span><br><span class="line">    size_t                max;</span><br><span class="line">    ngx_pool_t           *current;</span><br><span class="line">    ngx_chain_t          *chain;</span><br><span class="line">    ngx_pool_large_t     *large;</span><br><span class="line">    ngx_pool_cleanup_t   *cleanup;</span><br><span class="line">    ngx_log_t            *log;</span><br><span class="line">#if  (NGX_DEBUG_POOL)</span><br><span class="line">    size_t                size;</span><br><span class="line">    ngx_pool_stat_t      *stat;</span><br><span class="line">#endif</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ngx_pool_s 包含了结构 ngx_pool_data_t。变量后面加和$的区别是后者展开了里面的结构而前者不展开，此用法只输出基本数据类型的值。</p>
<h3 id="7-8-输出字符串指针"><a href="#7-8-输出字符串指针" class="headerlink" title="7.8 输出字符串指针"></a>7.8 输出字符串指针</h3><p>用户态使用：user_string、user_string_n 内核态使用：kernel_string、kernel_string_n、user_string_quoted</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#cat get_http_uri.stp</span><br><span class="line">probe process(&quot;/home/admin/tengine/bin/nginx&quot;).function(&quot;ngx_http_process_request&quot;).call &#123;</span><br><span class="line">    printf(&quot;r-&gt;uri: %s\nr-&gt;uri(n): %s\n&quot;, user_string($r-&gt;uri-&gt;data), user_string_n($r-&gt;uri-&gt;data, $r-&gt;uri-&gt;len))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#stap get_http_uri.stp</span><br><span class="line">r-&gt;uri: /?id=1 HTTP/1.1</span><br><span class="line">User-Agent</span><br><span class="line">r-&gt;uri(n): /</span><br><span class="line">user_string_quoted 是获取用户态传给内核的字符串，代码中一般有__user 宏标记： image</span><br><span class="line"></span><br><span class="line">#cat sys_open.stp</span><br><span class="line">probe kernel.function(&quot;sys_open&quot;)</span><br><span class="line">&#123;</span><br><span class="line">    printf(&quot;filename: %s\n&quot;, user_string_quoted(pointer_arg(1)));</span><br><span class="line">&#125;</span><br><span class="line">#stap sys_open.stp </span><br><span class="line">filename: &quot;/var/log/auth.log&quot;</span><br><span class="line">filename: &quot;/proc/stat&quot;</span><br><span class="line">filename: &quot;/proc/uptime&quot;</span><br></pre></td></tr></table></figure>

<h3 id="7-9-指针类型转换"><a href="#7-9-指针类型转换" class="headerlink" title="7.9 指针类型转换"></a>7.9 指针类型转换</h3><p>SystemTap 提供 @cast 来实现指针类型转换，比如可以将 void *转成自己需要的类型： image image</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#cat get_c_fd.stp </span><br><span class="line">probe process(&quot;/home/admin/tengine/bin/nginx&quot;).function(&quot;ngx_http_process_request_line&quot;).call &#123;</span><br><span class="line">    printf(&quot;c-&gt;fd: %d\n&quot;, @cast($rev-&gt;data, &quot;ngx_connection_t&quot;)-&gt;fd)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#stap get_c_fd.stp </span><br><span class="line">c-&gt;fd: 3</span><br><span class="line">c-&gt;fd: 28</span><br><span class="line">c-&gt;fd: 30</span><br><span class="line">c-&gt;fd: 32</span><br><span class="line">c-&gt;fd: 34</span><br><span class="line">^C</span><br></pre></td></tr></table></figure>

<h3 id="7-10-定义某个类型的变量"><a href="#7-10-定义某个类型的变量" class="headerlink" title="7.10 定义某个类型的变量"></a>7.10 定义某个类型的变量</h3><p>同样是用 @cast，定义一个变量用来保存其转换后的地址即可，用法如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#cat get_c.stp </span><br><span class="line">probe process(&quot;/home/admin/tengine/bin/nginx&quot;).function(&quot;ngx_http_process_request_line&quot;).call &#123;</span><br><span class="line">    c = &amp;@cast($rev-&gt;data, &quot;ngx_connection_t&quot;)</span><br><span class="line">    printf(&quot;c-&gt;fd: %d, c-&gt;requests: %d\n&quot;, c-&gt;fd, c-&gt;requests)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#stap get_c.stp </span><br><span class="line">c-&gt;fd: 3, c-&gt;requests: 1</span><br><span class="line">c-&gt;fd: 28, c-&gt;requests: 1</span><br><span class="line">c-&gt;fd: 30, c-&gt;requests: 1</span><br><span class="line">^C</span><br></pre></td></tr></table></figure>

<h3 id="7-11-多级指针用法"><a href="#7-11-多级指针用法" class="headerlink" title="7.11 多级指针用法"></a>7.11 多级指针用法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">root@j9 ~# cat cc_multi_pointer.c</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">struct test &#123;</span><br><span class="line">    int count;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">int main(int argc, char *argv[])</span><br><span class="line">&#123;   </span><br><span class="line">    struct test t = &#123;.count = 5566&#125;;</span><br><span class="line">    struct test *pt = &amp;t;</span><br><span class="line">    struct test **ppt = &amp;pt;</span><br><span class="line"></span><br><span class="line">    printf(&quot;t.count: %d, pt-&gt;count: %d, ppt-&gt;count: %d\n&quot;, t.count, pt-&gt;count, (*ppt)-&gt;count);</span><br><span class="line"></span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">root@j9 ~# gcc -Wall -g -o cc_multi_pointer ./cc_multi_pointer.c</span><br><span class="line"></span><br><span class="line">root@j9 ~# cat cc_multi_pointer.stp</span><br><span class="line">probe process(&quot;./cc_multi_pointer&quot;).statement(&quot;main@./cc_multi_pointer.c:13&quot;)</span><br><span class="line">&#123;   </span><br><span class="line">    printf(&quot;$t-&gt;count: %d, $pt-&gt;count: %d, $ppt-&gt;count: %d&quot;, $t-&gt;count, $pt-&gt;count, $ppt[0]-&gt;count);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">root@j9 ~# ./cc_multi_pointer</span><br><span class="line">t.count: 5566, pt-&gt;count: 5566, ppt-&gt;count: 5566</span><br><span class="line"></span><br><span class="line">root@j9 ~# stap ./cc_multi_pointer.stp -c &apos;./cc_multi_pointer&apos;</span><br><span class="line">t.count: 5566, pt-&gt;count: 5566, ppt-&gt;count: 5566</span><br><span class="line">$t-&gt;count: 5566, $pt-&gt;count: 5566, $ppt-&gt;count: 5566</span><br></pre></td></tr></table></figure>

<p>简言之：通过[0]去解引用即可。</p>
<h3 id="7-12-遍历-C-语言数组"><a href="#7-12-遍历-C-语言数组" class="headerlink" title="7.12 遍历 C 语言数组"></a>7.12 遍历 C 语言数组</h3><p>下面是在 nginx 处理请求关闭时遍历请求头的例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#cat debug_http_header.stp</span><br><span class="line">probe process(&quot;/home/admin/tengine/bin/nginx&quot;).function(&quot;ngx_http_finalize_request&quot;).call &#123;</span><br><span class="line">    i = 0</span><br><span class="line">    headers_in_part = &amp;$r-&gt;headers_in-&gt;headers-&gt;part</span><br><span class="line">    headers = &amp;@cast(headers_in_part-&gt;elts, &quot;ngx_table_elt_t&quot;)[0]</span><br><span class="line">    while (headers) &#123;</span><br><span class="line">        if (i &gt;= headers_in_part-&gt;nelts) &#123;</span><br><span class="line">            if (!headers_in_part-&gt;next) &#123;</span><br><span class="line">                break</span><br><span class="line">            &#125;</span><br><span class="line">            headers_in_part = headers_in_part-&gt;next;</span><br><span class="line">            headers = &amp;@cast(headers_in_part-&gt;elts, &quot;ngx_table_elt_t&quot;)[0]</span><br><span class="line">            i = 0</span><br><span class="line">        &#125;</span><br><span class="line">        h = &amp;@cast(headers, &quot;ngx_table_elt_t&quot;)[i]</span><br><span class="line">        printf(&quot;%s: %s\n&quot;, user_string_n(h-&gt;key-&gt;data, h-&gt;key-&gt;len), user_string_n(h-&gt;value-&gt;data, h-&gt;value-&gt;len))</span><br><span class="line">        i += 1</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#stap debug_http_header.stp</span><br><span class="line">User-Agent: curl/7.29.0</span><br><span class="line">Host: 127.0.0.1:20090</span><br><span class="line">Accept: */*</span><br></pre></td></tr></table></figure>

<h3 id="7-13-查看函数指针所指的函数名"><a href="#7-13-查看函数指针所指的函数名" class="headerlink" title="7.13 查看函数指针所指的函数名"></a>7.13 查看函数指针所指的函数名</h3><p>获取一个地址所对应的符号： 用户态：usymname 内核态：symname</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#cat get_c_handler.stp</span><br><span class="line">probe process(&quot;/home/admin/tengine/bin/nginx&quot;).function(&quot;ngx_http_process_request_line&quot;).call &#123;</span><br><span class="line">    c = &amp;@cast($rev-&gt;data, &quot;ngx_connection_t&quot;)</span><br><span class="line">    printf(&quot;c-&gt;read-&gt;handlers: %s, c-&gt;write-&gt;handler: %s\n&quot;, usymname(c-&gt;read-&gt;handler), usymname(c-&gt;write-&gt;handler))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#stap get_c_handler.stp</span><br><span class="line">c-&gt;read-&gt;handlers: ngx_http_process_request_line, c-&gt;write-&gt;handler: ngx_http_empty_handler</span><br><span class="line">^C</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/10/31/SystemTap%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7%E4%B9%8B%E4%BA%8C/" data-id="ck2ego8x30000hgns4a59fayd" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/10/31/SystemTap%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7%E4%B9%8B%E4%B8%89/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          SystemTap使用技巧之三
        
      </div>
    </a>
  
  
    <a href="/2019/10/31/SystemTap%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7%E4%B9%8B%E4%B8%80/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">SystemTap使用技巧之一</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/10/31/SystemTap%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7%E4%B9%8B%E5%9B%9B/">SystemTap使用技巧之四</a>
          </li>
        
          <li>
            <a href="/2019/10/31/SystemTap%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7%E4%B9%8B%E4%B8%89/">SystemTap使用技巧之三</a>
          </li>
        
          <li>
            <a href="/2019/10/31/SystemTap%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7%E4%B9%8B%E4%BA%8C/">SystemTap使用技巧之二</a>
          </li>
        
          <li>
            <a href="/2019/10/31/SystemTap%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7%E4%B9%8B%E4%B8%80/">SystemTap使用技巧之一</a>
          </li>
        
          <li>
            <a href="/2019/10/31/GDB%E9%AB%98%E7%BA%A7%E7%94%A8%E6%B3%95/">GDB高级用法</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>